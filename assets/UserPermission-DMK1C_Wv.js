import{_ as T,s as b,r as m,o as N,c as f,d as u,Y as A,e as a,g as _,i as h,j as y,I as R,f as S,cA as D,cB as L,y as M,v as V}from"./index-Bx6Y8L80.js";import{E as H}from"./button-8bviUT_H.js";import{E as I}from"./tree-Bp6m8vKT.js";import"./checkbox-LjaCbo-5.js";import{h as U}from"./handleError-DD4JYoq7.js";/* empty css             *//* empty css                   *//* empty css                 */import{E as j}from"./index-slq3sC_j.js";import{E as v}from"./index-KJp6TXG9.js";import"./index-A4BGBRGh.js";import"./plugin-vue_export-helper-CqGSI99y.js";import"./index-AkNVqhGZ.js";import"./use-form-item-50hJ8Ppj.js";import"./icon-6zrsquxY.js";import"./select-BmMHn9PT.js";import"./popper-DBn8ulUn.js";import"./index-CuyxIfpa.js";import"./aria-BUADUvnR.js";import"./focus-trap-Ddg061Nm.js";import"./scrollbar-DuXO1tWo.js";import"./index-aFn2MKle.js";import"./castArray-CrUPC_Z8.js";import"./index-iw6eP590.js";import"./scroll-BawlEUY1.js";import"./isEqual-BM-Gj-iT.js";import"./_Uint8Array-B6mJ0Xm4.js";import"./_baseIteratee-CkjM3wkz.js";import"./index-zrRcpBp4.js";/* empty css                        */import"./index-CWCMyxJA.js";import"./input-CFaQgGx5.js";import"./index-DZY-cmUL.js";import"./vnode-DK7gyQZj.js";import"./validator-ulZFuTQV.js";const z={class:"permission-management"},Y={class:"permission-tree-container"},q={style:{"margin-bottom":"1rem"}},F={class:"permission-node"},G={class:"actions"},J={__name:"UserPermission",props:["userinfo"],setup(g){const k=b(),o=m(null),x={children:"children",label:"label"};let n=g;const p=m(null),c=m(!1),E=async()=>{var t;try{c.value=!0;let e=await D({id:n.userinfo.id}),s=await L({username:n.userinfo.username});p.value=s.data[0];let r=e.data;(t=o.value)==null||t.setCheckedKeys(r)}catch(e){U(e)}finally{c.value=!1}},w=async()=>{var t,e;try{const s=((t=o.value)==null?void 0:t.getCheckedKeys())||[],r=((e=o.value)==null?void 0:e.getHalfCheckedKeys())||[],i=K=>K.filter(P=>{const d=o.value.getNode(P);return!d.childNodes||d.childNodes.length===0}),l=i(s),B=i(r),C=[...l,...B];await j.confirm("确定要保存权限更改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await M({user_id:n.userinfo.id,permissions:C}),v.success("权限保存成功")}catch(s){s!=="cancel"&&v.error("保存失败："+s.message)}};return N(()=>{E()}),(t,e)=>{const s=I,r=H,i=V;return f(),u("div",z,[A((f(),u("div",Y,[a("span",q,"当前权限："+_(p.value),1),h(s,{ref_key:"permissionTreeRef",ref:o,data:R(k).permissionTreeData,props:x,"show-checkbox":"","node-key":"code","default-expand-all":"","check-strictly":!1},{default:y(({node:l})=>[a("div",F,[a("span",null,_(l.label),1)])]),_:1},8,["data"])])),[[i,c.value]]),a("div",G,[h(r,{type:"primary",onClick:w},{default:y(()=>e[0]||(e[0]=[S("保存权限设置")])),_:1})])])}}},be=T(J,[["__scopeId","data-v-49b36718"]]);export{be as default};
