import{r as y,o as E,b as O,_ as R,w as v,c as h,d as k,e as p,U as C,J as b,k as V,g as w,N as S}from"./index-DWtISIBF.js";import{E as x}from"./date-picker-B_H4_mfX.js";import"./input-B0bTKLmJ.js";import"./scrollbar-BMOxp_jN.js";import"./popper-BNb2tGl7.js";import"./button-DfREtLL_.js";import{d as t}from"./dayjs.min-t3tQ4ZJg.js";/* empty css             *//* empty css                 */import{E as D}from"./index-CZh1RU_w.js";function _(){const n=y(!1),o=()=>{n.value=window.innerWidth<=768};return E(()=>{o(),window.addEventListener("resize",o)}),O(()=>{window.removeEventListener("resize",o)}),n}const U={__name:"CustomDatePicker",props:{modelValue:{type:[Array,Number],required:!0},isRange:{type:Boolean,default:!0},isMonthPicker:{type:Boolean,default:!1},maxDays:{type:Number,default:90,validator:n=>n>0},minDays:{type:Number,default:0,validator:n=>n>=0}},emits:["update:modelValue"],setup(n,{expose:o,emit:r}){o();const e=n,c=r,M=_(),s=y(null),i=y(null),m=y(null),u=y(null);v(()=>e.modelValue,a=>{e.isRange?Array.isArray(a)&&(s.value=a,m.value=a[0],u.value=a[1]):i.value=a},{immediate:!0});const g=a=>{if(e.isMonthPicker){const l=t(a).startOf("month").valueOf(),d=t(a).endOf("month").valueOf();return[l,d]}else{const l=t(a).startOf("day").valueOf(),d=t(a).endOf("day").valueOf();return[l,d]}},P={props:e,emit:c,isMobile:M,dateRange:s,singleDate:i,startDate:m,endDate:u,getTimeRangeTimestamp:g,disabledDate:a=>{const l=t();return!!t(a).isAfter(l)},handleDateRangeChange:a=>{if(!a)return;let[l,d]=a;(e.isMonthPicker?t(l).isSame(t(d),"month"):t(l).isSame(t(d),"day"))&&([l,d]=g(l));const f=t(d).diff(t(l),"day");if(f>e.maxDays){D.error(`日期范围不能超过 ${e.maxDays} 天`),s.value=null;return}if(f<e.minDays){D.error(`日期范围不能小于 ${e.minDays} 天`),s.value=null;return}c("update:modelValue",[l,d])},handleSingleDateChange:a=>{if(a)if(e.isMonthPicker){const[l,d]=g(a);c("update:modelValue",l)}else c("update:modelValue",a)},handleMobileStartDateChange:a=>{if(!a){m.value=null;return}if(u.value){const l=t(u.value).diff(t(a),"day");if(l>e.maxDays){D.error(`日期范围不能超过 ${e.maxDays} 天`),m.value=null;return}if(l<e.minDays){D.error(`日期范围不能小于 ${e.minDays} 天`),m.value=null;return}if(e.isMonthPicker?t(a).isSame(t(u.value),"month"):t(a).isSame(t(u.value),"day")){const[d,f]=g(a);c("update:modelValue",[d,f]);return}c("update:modelValue",[a,u.value])}},handleMobileEndDateChange:a=>{if(!a){u.value=null;return}if(m.value){const l=t(a).diff(t(m.value),"day");if(l>e.maxDays){D.error(`日期范围不能超过 ${e.maxDays} 天`),u.value=null;return}if(l<e.minDays){D.error(`日期范围不能小于 ${e.minDays} 天`),u.value=null;return}if(e.isMonthPicker?t(a).isSame(t(m.value),"month"):t(a).isSame(t(m.value),"day")){const[d,f]=g(a);c("update:modelValue",[d,f]);return}c("update:modelValue",[m.value,a])}},ref:y,watch:v,get dayjs(){return t},get useMobileDetection(){return _}};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}},B={key:0,class:"mobile-date-picker"},N={class:"mobile-date-input"},A={class:"separator"},j={class:"mobile-date-input"};function z(n,o,r,e,c,M){const s=x;return h(),k("div",{class:S(["filter-header",{"filter-header--mobile":e.isMobile}])},[p("div",{class:S(["date-picker-wrapper",{"date-picker-wrapper--mobile":e.isMobile}])},[e.isMobile?(h(),k(C,{key:1},[r.isRange?(h(),k("div",B,[p("div",N,[V(s,{style:{width:"8rem"},modelValue:e.startDate,"onUpdate:modelValue":o[2]||(o[2]=i=>e.startDate=i),type:r.isMonthPicker?"month":"date",placeholder:n.$t(r.isMonthPicker?"monthPlaceholderStart":"datePlaceholderStart"),"disabled-date":e.disabledDate,"value-format":"x",onChange:e.handleMobileStartDateChange},null,8,["modelValue","type","placeholder"])]),p("span",A,w(n.$t("date.to")),1),p("div",j,[V(s,{style:{width:"8rem"},modelValue:e.endDate,"onUpdate:modelValue":o[3]||(o[3]=i=>e.endDate=i),type:r.isMonthPicker?"month":"date",placeholder:n.$t(r.isMonthPicker?"monthPlaceholderEnd":"datePlaceholderEnd"),"disabled-date":e.disabledDate,"value-format":"x",onChange:e.handleMobileEndDateChange},null,8,["modelValue","type","placeholder"])])])):(h(),b(s,{key:1,modelValue:e.singleDate,"onUpdate:modelValue":o[4]||(o[4]=i=>e.singleDate=i),type:r.isMonthPicker?"month":"date",placeholder:n.$t(r.isMonthPicker?"monthPlaceholder":"datePlaceholder"),"value-format":"x","disabled-date":e.disabledDate,onChange:e.handleSingleDateChange,class:"date-picker"},null,8,["modelValue","type","placeholder"]))],64)):(h(),k(C,{key:0},[r.isRange?(h(),b(s,{key:0,modelValue:e.dateRange,"onUpdate:modelValue":o[0]||(o[0]=i=>e.dateRange=i),type:r.isMonthPicker?"monthrange":"daterange","unlink-panels":"","range-separator":n.$t("date.to"),"start-placeholder":n.$t(r.isMonthPicker?"monthPlaceholderStart":"datePlaceholderStart"),"end-placeholder":n.$t(r.isMonthPicker?"monthPlaceholderEnd":"datePlaceholderEnd"),"disabled-date":e.disabledDate,"value-format":"x",onChange:e.handleDateRangeChange,class:"date-picker"},null,8,["modelValue","type","range-separator","start-placeholder","end-placeholder"])):(h(),b(s,{key:1,modelValue:e.singleDate,"onUpdate:modelValue":o[1]||(o[1]=i=>e.singleDate=i),type:r.isMonthPicker?"month":"date",placeholder:n.$t(r.isMonthPicker?"monthPlaceholder":"datePlaceholder"),"value-format":"x","disabled-date":e.disabledDate,onChange:e.handleSingleDateChange,class:"date-picker"},null,8,["modelValue","type","placeholder"]))],64))],2)],2)}const ee=R(U,[["render",z],["__scopeId","data-v-7fae3c3e"],["__file","D:/临时存放/green-carbon-1.0/src/components/header/CustomDatePicker.vue"]]);export{ee as C};
