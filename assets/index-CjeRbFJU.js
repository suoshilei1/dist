import{_ as T,u as z,r as l,o as B,a$ as F,c,d as V,Y as U,e as m,k as n,l as i,U as D,V as x,J as P,f as w,g as L,m as A,a7 as I,v as K}from"./index-DWtISIBF.js";import{E as q}from"./dialog-DnmK2X7S.js";import"./overlay-BY0G5ok6.js";import{E as R}from"./pagination-BRd1ibtD.js";/* empty css            */import{E as j,a as J}from"./select-DYqyOwb9.js";import"./scrollbar-BMOxp_jN.js";import"./popper-BNb2tGl7.js";import{E as Y}from"./card-Cr9tAXzl.js";import{E as G}from"./empty-CAh1XabF.js";import{E as H}from"./button-DfREtLL_.js";import{f as Q}from"./date-C99jBCbl.js";import{C as W}from"./CompanyDialog-CfbOzTAZ.js";import{C as X}from"./CompanyAutoInput-CP9TMa5e.js";/* empty css             *//* empty css                        */import{E as Z}from"./index-DYLzNb0k.js";import{E as $}from"./index-0A8HTOTd.js";import{E as ee}from"./index-CuP5NVML.js";import"./index-DxRU3L2W.js";import"./scroll-DMdoCUCr.js";import"./vnode-BIvhTfyw.js";import"./plugin-vue_export-helper-CqGSI99y.js";import"./icon-Cc3ZZocH.js";import"./focus-trap-D8pg8SM_.js";import"./aria-BUADUvnR.js";import"./refs-BfLSHSPd.js";import"./index-DjvbDGpK.js";import"./index-CVAPKPs0.js";import"./use-form-item-CuJrx89H.js";import"./index-DibVzrKz.js";import"./isEqual-DqXByToB.js";import"./_Uint8Array-DaZSNKBQ.js";import"./input-B0bTKLmJ.js";import"./castArray-6TPyo715.js";import"./_baseIteratee-FAqII4j1.js";import"./index-DfeXTFmx.js";import"./dayjs.min-t3tQ4ZJg.js";import"./form-item-ijUMtc9_.js";import"./_initCloneObject-ChNElRpx.js";import"./autocomplete-DkTQJXpJ.js";import"./index-CZh1RU_w.js";import"./index-BTG_XGfc.js";import"./validator-CunO4hgy.js";const te={__name:"index",setup(M,{expose:o}){o();let f=z(),e=l(""),v=l(""),C=l(""),s=l(""),d=l([]),p=l(1),g=l(20),h=l(0),S=l([]),b=l([]),_=l(!1),u=l(null),y=l(!1);const k=()=>{e.value="",v.value="",C.value="",s.value="",a()};B(()=>{a()});const a=()=>{y.value=!0,u.value=null,_.value=!1;const t={offset:g.value*(p.value-1),limit:g.value,name:e.value,status:v.value,sector:C.value,product_name:s.value};F(t).then(r=>{r.code===200?(d.value=r.data.companies,S.value=r.available_list.sector,b.value=r.available_list.product_name,h.value=r.data.total):E("获取公司列表失败",r.message)}).catch(r=>{E("获取公司列表失败",r.message)}).finally(()=>{y.value=!1})},E=(t,r)=>{Z({title:t,message:r||"操作失败，请稍后重试",type:"error",duration:5e3,position:"top-right"})};function N(t){e.value=t.name,a()}const O={get router(){return f},set router(t){f=t},get searchKeyword(){return e},set searchKeyword(t){e=t},get selectedStatus(){return v},set selectedStatus(t){v=t},get selectedSector(){return C},set selectedSector(t){C=t},get selectedProduct(){return s},set selectedProduct(t){s=t},get companyList(){return d},set companyList(t){d=t},get currentPage(){return p},set currentPage(t){p=t},get pageSize(){return g},set pageSize(t){g=t},get total(){return h},set total(t){h=t},get sectorOptions(){return S},set sectorOptions(t){S=t},get productOptions(){return b},set productOptions(t){b=t},get dialogVisible(){return _},set dialogVisible(t){_=t},get currentCompany(){return u},set currentCompany(t){u=t},get loading(){return y},set loading(t){y=t},resetFields:k,fetchCompanyList:a,showErrorNotification:E,handleSelect:N,addCompany:()=>{u.value=null,f.push({name:"MapSelector",query:{from:"CompanyList"}})},editCompany:t=>{u.value=t.id,_.value=!0},goToCompanyDetail:t=>{f.push({name:"CompanyDetail",query:{id:t}})},handlePageChange:t=>{p.value=t,a()},ref:l,onMounted:B,get useRouter(){return z},get Setting(){return I},get getCompanyListApi(){return F},get formatDate(){return Q},CompanyDialog:W,CompanyAutoInput:X};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}},ae={class:"company-list",style:{height:"100%"},"element-loading-text":"Loading...","element-loading-background":"rgba(122, 122, 122, 0.1)"},oe={class:"search-bar"},le={class:"company-cards"},ne={class:"card-body"},re={class:"company-sector"},ie={class:"time-info"};function se(M,o,f,e,v,C){var k;const s=j,d=J,p=H,g=G,h=$,S=ee,b=Y,_=R,u=q,y=K;return c(),V(D,null,[U((c(),V("div",ae,[m("div",oe,[n(e.CompanyAutoInput,{style:{"margin-right":"1rem"},onSelect:e.handleSelect}),n(d,{modelValue:e.selectedStatus,"onUpdate:modelValue":o[0]||(o[0]=a=>e.selectedStatus=a),placeholder:"选择状态",class:"status-select",onChange:e.fetchCompanyList},{default:i(()=>[n(s,{label:"在用",value:1}),n(s,{label:"停用",value:2})]),_:1},8,["modelValue"]),n(d,{modelValue:e.selectedSector,"onUpdate:modelValue":o[1]||(o[1]=a=>e.selectedSector=a),placeholder:"选择行业",class:"sector-select",onChange:e.fetchCompanyList},{default:i(()=>[(c(!0),V(D,null,x(e.sectorOptions,a=>(c(),P(s,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),n(d,{modelValue:e.selectedProduct,"onUpdate:modelValue":o[2]||(o[2]=a=>e.selectedProduct=a),placeholder:"选择产品",class:"product-select",onChange:e.fetchCompanyList},{default:i(()=>[(c(!0),V(D,null,x(e.productOptions,a=>(c(),P(s,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),n(p,{type:"primary",onClick:e.resetFields,class:"reset-button"},{default:i(()=>o[4]||(o[4]=[w("重置")])),_:1}),n(p,{type:"primary",onClick:e.addCompany,class:"add-button"},{default:i(()=>o[5]||(o[5]=[w("新增公司")])),_:1})]),m("div",le,[!((k=e.companyList)!=null&&k.length)&&!e.loading?(c(),P(g,{key:0,description:"暂无数据",style:{width:"100%",height:"100%"}})):(c(!0),V(D,{key:1},x(e.companyList,a=>(c(),P(b,{key:a.id,class:"company-card",shadow:"hover",onClick:E=>e.goToCompanyDetail(a.id)},{header:i(()=>[n(h,{type:a.status===1?"success":"danger",class:"status-tag",effect:"plain",size:"small"},{default:i(()=>[w(L(a.status===1?"在用":"停用"),1)]),_:2},1032,["type"]),n(S,{class:"settings-icon",size:"1.4rem",onClick:A(E=>e.editCompany(a),["stop"])},{default:i(()=>[n(e.Setting)]),_:2},1032,["onClick"])]),default:i(()=>[m("div",ne,[m("h3",null,L(a.name),1),m("p",re,L(a.sector||"暂无"),1),m("div",ie,[m("span",null,"创建："+L(e.formatDate(a.created_at)),1),m("span",null,"更新："+L(e.formatDate(a.updated_at)),1)])])]),_:2},1032,["onClick"]))),128))]),n(_,{onCurrentChange:e.handlePageChange,"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,"hide-on-single-page":!0,background:"","pager-count":5,layout:"prev, pager, next",class:"pagination"},null,8,["current-page","page-size","total"])])),[[y,e.loading]]),n(u,{class:"company-dialog",title:e.currentCompany?"编辑公司":"新增公司","align-center":"",modelValue:e.dialogVisible,"onUpdate:modelValue":o[3]||(o[3]=a=>e.dialogVisible=a)},{default:i(()=>[n(e.CompanyDialog,{onFetchCompanyList:e.fetchCompanyList,id:e.currentCompany},null,8,["id"])]),_:1},8,["title","modelValue"])],64)}const ot=T(te,[["render",se],["__scopeId","data-v-16e0471a"],["__file","D:/临时存放/green-carbon-1.0/src/views/SystemManagement/CompanyManagement/CompanyList/index.vue"]]);export{ot as default};
