import{z as _e,A as ke,B as we,C as Se,D as Z,E as ve,r as u,F as E,G as Pe,H as Ee,w as te,c as d,d as v,n as G,I as P,J as M,l as c,K as se,M as R,N as x,O as he,P as De,Q as Me,R as Ae,S as Ie,e as m,h as z,g as B,_ as re,u as j,q as ae,T as ne,o as q,U as W,V as ie,s as Q,W as Y,i as le,X as Le,Y as J,k as l,f as F,Z as Te,$ as Ve,a0 as Be,a1 as Fe,a2 as ze,a3 as Ue,a4 as ce,v as ye,b as de,j as Ne,a5 as Re}from"./index-DWtISIBF.js";import{E as Ce}from"./button-DfREtLL_.js";/* empty css             */import{E as Ge,a as He,b as Oe,c as We}from"./header-BNIxu-rR.js";import{E as je}from"./dialog-DnmK2X7S.js";import"./overlay-BY0G5ok6.js";import{E as qe,a as Qe}from"./form-item-ijUMtc9_.js";import{E as Ye}from"./input-B0bTKLmJ.js";/* empty css                     */import"./popper-BNb2tGl7.js";import"./scrollbar-BMOxp_jN.js";import{E as Je,a as Ke,b as Xe}from"./dropdown-item-DTdyfjYD.js";import{u as K}from"./area-CDc72icr.js";import{u as X}from"./meter-BWYCtTLu.js";import{C as Ze}from"./CompanyAutoInput-CP9TMa5e.js";import{c as me}from"./user-DcE5FH17.js";import{s as ee}from"./sha256-BWhxwb84.js";/* empty css             *//* empty css                 *//* empty css                   */import{E as V}from"./index-CZh1RU_w.js";import{E as be}from"./index-CuP5NVML.js";import{i as $e}from"./icon-Cc3ZZocH.js";import{_ as xe}from"./plugin-vue_export-helper-CqGSI99y.js";import{E as et}from"./index-BTG_XGfc.js";/* empty css                        */import{_ as tt}from"./logo-rRFpfryy.js";import{E as O}from"./index-DYLzNb0k.js";import"./index-DjvbDGpK.js";import"./use-form-item-CuJrx89H.js";import"./index-DxRU3L2W.js";import"./scroll-DMdoCUCr.js";import"./vnode-BIvhTfyw.js";import"./focus-trap-D8pg8SM_.js";import"./aria-BUADUvnR.js";import"./refs-BfLSHSPd.js";import"./index-CVAPKPs0.js";import"./castArray-6TPyo715.js";import"./_Uint8Array-DaZSNKBQ.js";import"./_initCloneObject-ChNElRpx.js";import"./index-DibVzrKz.js";import"./dayjs.min-t3tQ4ZJg.js";import"./autocomplete-DkTQJXpJ.js";import"./validator-CunO4hgy.js";const st=_e({size:{type:[Number,String],values:ke,default:"",validator:p=>we(p)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:$e},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:Se(String),default:"cover"}}),rt={error:p=>p instanceof Event},ot=Z({name:"ElAvatar"}),at=Z({...ot,props:st,emits:rt,setup(p,{emit:t}){const r=p,e=ve("avatar"),o=u(!1),g=E(()=>{const{size:n,icon:k,shape:_}=r,a=[e.b()];return Pe(n)&&a.push(e.m(n)),k&&a.push(e.m("icon")),_&&a.push(e.m(_)),a}),s=E(()=>{const{size:n}=r;return we(n)?e.cssVarBlock({size:Ee(n)||""}):void 0}),i=E(()=>({objectFit:r.fit}));te(()=>r.src,()=>o.value=!1);function f(n){o.value=!0,t("error",n)}return(n,k)=>(d(),v("span",{class:x(P(g)),style:G(P(s))},[(n.src||n.srcSet)&&!o.value?(d(),v("img",{key:0,src:n.src,alt:n.alt,srcset:n.srcSet,style:G(P(i)),onError:f},null,44,["src","alt","srcset"])):n.icon?(d(),M(P(be),{key:1},{default:c(()=>[(d(),M(se(n.icon)))]),_:1})):R(n.$slots,"default",{key:2})],6))}});var nt=xe(at,[["__file","avatar.vue"]]);const it=he(nt),U={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},ue={[U.success]:De,[U.warning]:Me,[U.error]:Ae,[U.info]:Ie},lt=_e({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["success","warning","info","error"],default:"info"}}),ct=Z({name:"ElResult"}),dt=Z({...ct,props:lt,setup(p){const t=p,r=ve("result"),e=E(()=>{const o=t.icon,g=o&&U[o]?U[o]:"icon-info",s=ue[g]||ue["icon-info"];return{class:g,component:s}});return(o,g)=>(d(),v("div",{class:x(P(r).b())},[m("div",{class:x(P(r).e("icon"))},[R(o.$slots,"icon",{},()=>[P(e).component?(d(),M(se(P(e).component),{key:0,class:x(P(e).class)},null,8,["class"])):z("v-if",!0)])],2),o.title||o.$slots.title?(d(),v("div",{key:0,class:x(P(r).e("title"))},[R(o.$slots,"title",{},()=>[m("p",null,B(o.title),1)])],2)):z("v-if",!0),o.subTitle||o.$slots["sub-title"]?(d(),v("div",{key:1,class:x(P(r).e("subtitle"))},[R(o.$slots,"sub-title",{},()=>[m("p",null,B(o.subTitle),1)])],2)):z("v-if",!0),o.$slots.extra?(d(),v("div",{key:2,class:x(P(r).e("extra"))},[R(o.$slots,"extra")],2)):z("v-if",!0)],2))}});var mt=xe(dt,[["__file","result.vue"]]);const ut=he(mt),pt="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Creator:%20CorelDRAW%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='19.5692mm'%20height='17.7047mm'%20style='shape-rendering:geometricPrecision;%20text-rendering:geometricPrecision;%20image-rendering:optimizeQuality;%20fill-rule:evenodd;%20clip-rule:evenodd'%20viewBox='0%200%200.671195%200.607245'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c![CDATA[%20.str1%20{stroke:%23fff;stroke-width:0.0242011}%20.str0%20{stroke:%23fff;stroke-width:0.0242011;stroke-linecap:round;stroke-linejoin:round}%20.fil0%20{fill:none}%20]]%3e%3c/style%3e%3c/defs%3e%3cg%20id='图层_x0020_1'%3e%3cmetadata%20id='CorelCorpID_0Corel-Layer'/%3e%3cg%20id='_772231312'%3e%3cpath%20id='_325112704'%20class='fil0%20str0'%20d='M0.00779949%200.288516l0.325493%20-0.276446%200.325836%200.280219m-0.651329%20-0.00377284z'/%3e%3cpath%20id='_325113616'%20class='fil0%20str1'%20d='M0.272584%200.391755l0.122103%200c0.0209221,0%200.0380714,0.0171493%200.0380714,0.0380714l0%200.165319%20-0.198589%200%200%20-0.165319c0,-0.0209221%200.0171493,-0.0380714%200.0384144,-0.0380714z'/%3e%3cpath%20id='_325113184'%20class='fil0%20str1'%20d='M0.581957%200.226093l0%200.311088c0,0.0315547%20-0.0257239,0.0572786%20-0.0572786,0.0572786l-0.382429%200c-0.0315547,0%20-0.0572786,-0.0257239%20-0.0572786,-0.0572786l0%20-0.311088'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",gt="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Creator:%20CorelDRAW%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='23.6091mm'%20height='17.58mm'%20style='shape-rendering:geometricPrecision;%20text-rendering:geometricPrecision;%20image-rendering:optimizeQuality;%20fill-rule:evenodd;%20clip-rule:evenodd'%20viewBox='0%200%201.21653%200.905866'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c![CDATA[%20.str0%20{stroke:%23fff;stroke-width:0.0363583;stroke-linecap:round}%20.fil1%20{fill:none;fill-rule:nonzero}%20.fil2%20{fill:%23fff}%20.fil0%20{fill:%23fff;fill-rule:nonzero}%20]]%3e%3c/style%3e%3c/defs%3e%3cg%20id='图层_x0020_1'%3e%3cmetadata%20id='CorelCorpID_0Corel-Layer'/%3e%3cg%20id='_770419928'%3e%3cpolygon%20id='_325717624'%20class='fil0'%20points='0.090128,0.905866%200.090128,0.749735%200.218948,0.646679%200.218948,0.905866%20'/%3e%3cpolygon%20id='_325718632'%20class='fil0'%20points='0.39466,0.905866%200.39466,0.506007%200.447218,0.463754%200.52348,0.523011%200.52348,0.905866%20'/%3e%3cpolygon%20id='_325719040'%20class='fil0'%20points='0.699191,0.905866%200.699191,0.659046%200.707951,0.665744%200.828012,0.563203%200.828012,0.905866%20'/%3e%3cpolygon%20id='_325719064'%20class='fil0'%20points='1.00372,0.905866%201.00372,0.412741%201.13203,0.302471%201.13203,0.905866%20'/%3e%3cpath%20id='_325719160'%20class='fil1%20str0'%20d='M0.0112898%200.597212l0.390584%20-0.311746%200.25661%200.197868%200.428715%20-0.366881m-1.07591%200.480758z'/%3e%3cpolygon%20id='_325719880'%20class='fil2'%20points='1.21653,0.00979036%201.2052,0.132427%201.19438,0.25558%201.08205,0.12779%200.969714,0%201.09338,0.00463754%20'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",ft="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Creator:%20CorelDRAW%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='17.6556mm'%20height='17.6556mm'%20style='shape-rendering:geometricPrecision;%20text-rendering:geometricPrecision;%20image-rendering:optimizeQuality;%20fill-rule:evenodd;%20clip-rule:evenodd'%20viewBox='0%200%200.926785%200.926785'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c![CDATA[%20.str0%20{stroke:%23fff;stroke-width:0.0370387}%20.fil0%20{fill:none}%20]]%3e%3c/style%3e%3c/defs%3e%3cg%20id='图层_x0020_1'%3e%3cmetadata%20id='CorelCorpID_0Corel-Layer'/%3e%3cg%20id='_772230232'%3e%3cpath%20id='_325716160'%20class='fil0%20str0'%20d='M0.710895%200.0185193c0.109184,0%200.197372,0.0887122%200.197372,0.197896%200,0.109184%20-0.0881873,0.197372%20-0.197372,0.197372l-0.197896%200%200%20-0.197372c0,-0.109184%200.0887122,-0.197896%200.197896,-0.197896z'/%3e%3cpath%20id='_325716232'%20class='fil0%20str0'%20d='M0.710895%200.908266c0.109184,0%200.197372,-0.0887122%200.197372,-0.197896%200,-0.109184%20-0.0881873,-0.197372%20-0.197372,-0.197372l-0.197896%200%200%200.197372c0,0.109184%200.0887122,0.197896%200.197896,0.197896z'/%3e%3cpath%20id='_325716256'%20class='fil0%20str0'%20d='M0.216416%200.0185193c-0.109184,0%20-0.197896,0.0887122%20-0.197896,0.197896%200,0.109184%200.0887122,0.197372%200.197896,0.197372l0.197896%200%200%20-0.197372c0,-0.109184%20-0.0887122,-0.197896%20-0.197896,-0.197896z'/%3e%3cpath%20id='_325717144'%20class='fil0%20str0'%20d='M0.216416%200.908266c-0.109184,0%20-0.197896,-0.0887122%20-0.197896,-0.197896%200,-0.109184%200.0887122,-0.197372%200.197896,-0.197372l0.197896%200%200%200.197372c0,0.109184%20-0.0887122,0.197896%20-0.197896,0.197896z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",_t="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Creator:%20CorelDRAW%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='19.3945mm'%20height='17.7656mm'%20style='shape-rendering:geometricPrecision;%20text-rendering:geometricPrecision;%20image-rendering:optimizeQuality;%20fill-rule:evenodd;%20clip-rule:evenodd'%20viewBox='0%200%201.67843%201.53747'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c![CDATA[%20.str0%20{stroke:%23fff;stroke-width:0.0610639}%20.str1%20{stroke:%23fff;stroke-width:0.0610639;stroke-linejoin:round}%20.str2%20{stroke:%23fff;stroke-width:0.0610639;stroke-linecap:round}%20.str3%20{stroke:%23fff;stroke-width:0.0610639;stroke-linecap:round;stroke-linejoin:round}%20.fil0%20{fill:none}%20.fil1%20{fill:black}%20]]%3e%3c/style%3e%3c/defs%3e%3cg%20id='图层_x0020_1'%3e%3cmetadata%20id='CorelCorpID_0Corel-Layer'/%3e%3cg%20id='_772230664'%3e%3cpath%20id='_325082440'%20class='fil0%20str0'%20d='M0.494396%201.42472l-0.334917%200c-0.0709643,0%20-0.128947,-0.057983%20-0.128947,-0.129813l0%20-1.13456c0,-0.0709643%200.057983,-0.129813%200.128947,-0.129813l1.1787%200c0.0709643,0%200.128947,0.0588484%200.128947,0.129813l0%201.07745'/%3e%3cpolygon%20id='_325082728'%20class='fil0%20str1'%20points='1.03528,0.644979%201.34164,1.07596%201.648,1.50693%201.03528,1.50693%200.423432,1.50693%200.72979,1.07596%20'/%3e%3cline%20id='_325083352'%20class='fil0%20str2'%20x1='0.282369'%20y1='0.391411'%20x2='1.21096'%20y2=%20'0.391411'%20/%3e%3cline%20id='_325082992'%20class='fil0%20str3'%20x1='0.278907'%20y1='0.696904'%20x2='0.681326'%20y2=%20'0.696904'%20/%3e%3cline%20id='_325083496'%20class='fil0%20str2'%20x1='0.27458'%20y1='1.05778'%20x2='0.520358'%20y2=%20'1.05778'%20/%3e%3cline%20id='_323923864'%20class='fil0%20str3'%20x1='1.04567'%20y1='1.24558'%20x2='1.04567'%20y2=%20'0.883834'%20/%3e%3ccircle%20id='_323925088'%20class='fil1'%20cx='1.05086'%20cy='1.38837'%20r='0.0588484'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",wt="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Creator:%20CorelDRAW%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='18.8056mm'%20height='17.5656mm'%20style='shape-rendering:geometricPrecision;%20text-rendering:geometricPrecision;%20image-rendering:optimizeQuality;%20fill-rule:evenodd;%20clip-rule:evenodd'%20viewBox='0%200%203.28349%203.06699'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c![CDATA[%20.str1%20{stroke:%23fff;stroke-width:0.123199}%20.str0%20{stroke:%23fff;stroke-width:0.123199;stroke-linecap:round}%20.fil0%20{fill:none}%20]]%3e%3c/style%3e%3c/defs%3e%3cg%20id='图层_x0020_1'%3e%3cmetadata%20id='CorelCorpID_0Corel-Layer'/%3e%3cg%20id='_770422112'%3e%3cpath%20id='_325743304'%20class='fil0%20str0'%20d='M0.0615995%200.402073l0.783962%200m0.680947%200l1.69538%200'/%3e%3cpath%20id='_325743064'%20class='fil0%20str0'%20d='M0.0615995%201.54572l1.69538%200m0.682693%200l0.782216%200'/%3e%3cpath%20id='_325743184'%20class='fil0%20str0'%20d='M0.0615995%202.66491l0.747296%200m0.682693%200l1.7303%200'/%3e%3ccircle%20id='_325743400'%20class='fil0%20str1'%20cx='1.18604'%20cy='0.402073'%20r='0.340474'/%3e%3ccircle%20id='_325744072'%20class='fil0%20str1'%20cx='2.09746'%20cy='1.54572'%20r='0.340474'/%3e%3ccircle%20id='_325743904'%20class='fil0%20str1'%20cx='1.15112'%20cy='2.66491'%20r='0.340474'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",pe=[{path:"/dashboard",title:"首页",icon:pt},{path:"/energy-data",title:"用能数据",icon:gt,children:[{path:"/energy-data/carbon",title:"能碳监控"},{path:"/energy-data/water-data",title:"用水数据"},{path:"/energy-data/electricity-data",title:"用电数据"}]},{path:"/device-center",title:"设备中心",icon:ft,children:[{path:"/device-center/console",title:"控制台"},{path:"/device-center/device-info",title:"设备信息"},{path:"/device-center/device-architecture",title:"设备架构"}]},{path:"/warning-center",title:"异常处理中心",icon:_t,children:[{path:"/warning-center/exception-handling",title:"异常处理"},{path:"/warning-center/water-leakage-analysis",title:"智能漏损分析"}]},{path:"/system-management",title:"系统管理",icon:wt,children:[{path:"/system-management/company-management",title:"公司管理"},{path:"/system-management/user-management",title:"用户管理"},{path:"/system-management/block-management",title:"区块管理"},{path:"/system-management/push-management",title:"推送管理"},{path:"/system-management/formula-management",title:"公式管理"},{path:"/system-management/constant-management",title:"常量管理"}]}],vt={"/dashboard":["view_simple_dashboard","view_big_screen"],"/dashboard/big-screen":["view_big_screen"],"/energy-data":["view_water_chart","view_water_daily_report","manage_water_meter","view_water_cost","view_electricity_chart","view_electricity_daily_report","manage_electricity_meter","view_electricity_cost"],"/energy-data/carbon":["view_carbon_data"],"/energy-data/water-data":["view_water_chart","view_water_daily_report","manage_water_meter","view_water_cost"],"/energy-data/electricity-data":["view_electricity_chart","view_electricity_daily_report","manage_electricity_meter","view_electricity_cost"],"/device-center":["view_device_console","control_device","view_device_info","manage_device"],"/device-center/console":["view_device_console","control_device"],"/device-center/device-info":["view_device_info"],"/device-center/device-architecture":["view_device_architecture"],"/warning-center":["view_exceptions","handle_exceptions","view_leakage"],"/warning-center/exception-handling":["view_exceptions","handle_exceptions"],"/warning-center/water-leakage-analysis":["view_leakage"],"/system-management":["manage_company","view_company","manage_block","manage_push","manage_formula","manage_user_permissions","manage_constant","manage_user","view_user"],"/system-management/company-management":["manage_company"],"/system-management/user-management":["manage_user"],"/system-management/block-management":["manage_block"],"/system-management/push-management":["manage_push"],"/system-management/formula-management":["manage_formula"],"/system-management/constant-management":["manage_constant"]};function ge(p,t){const r=vt[p];return r?r.some(e=>t.includes(e)):!0}function fe(p,t){return p.filter(r=>ge(r.path,t)).map(r=>{if(r.children){const e=r.children.filter(o=>ge(o.path,t));return e.length===0?null:{...r,children:e}}return r}).filter(Boolean)}const ht={__name:"NavList",props:{isCollapse:{type:Boolean,default:!1},isMobile:{type:Boolean,default:!1}},setup(p,{expose:t}){t();const r=p,e=j(),o=ae(),g=u(window.location.pathname),s=u([]),i=u({}),f=E(()=>fe(pe,o.userPermissions));ne(()=>{const a=g.value;f.value.forEach(h=>{h.children&&h.children.some(C=>C.path===a)&&(s.value.includes(h.path)||s.value.push(h.path))})}),q(()=>{f.value.forEach(a=>{if(a.children){const b=a.children.length*44+(a.children.length-1)*4+6;i.value[a.path]=b,a.children.some(L=>L.path===g.value)&&s.value.push(a.path)}})});const _={props:r,router:e,permissionStore:o,activeIndex:g,openSubmenus:s,submenuHeight:i,permissionFilteredMenu:f,handleMenuClick:a=>{g.value=a,e.push(a)},toggleSubmenu:a=>{const h=s.value.indexOf(a);h===-1?s.value.push(a):s.value.splice(h,1)},ref:u,computed:E,onMounted:q,watchEffect:ne,get useRouter(){return j},get menuConfig(){return pe},get usePermissionStore(){return ae},get filterMenuByPermissions(){return fe}};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}},yt={class:"menu-list"},Ct=["onClick"],bt=["src"],xt={class:"menu-title"},kt=["onClick"],St=["src"],Pt={class:"menu-title"},Et={class:"submenu-list"},Dt=["onClick"];function Mt(p,t,r,e,o,g){return d(),v("nav",{class:x(["side-menu",{collapsed:r.isCollapse&&!r.isMobile}])},[m("ul",yt,[(d(!0),v(W,null,ie(e.permissionFilteredMenu,s=>(d(),v(W,{key:s.path},[s.children?(d(),v("li",{key:1,class:x(["submenu",{open:e.openSubmenus.includes(s.path)}])},[m("div",{class:"submenu-title",onClick:i=>e.toggleSubmenu(s.path)},[m("img",{src:s.icon,style:{fill:"currentColor",color:"gray"},alt:"",class:"menu-icon"},null,8,St),m("span",Pt,B(s.title),1),t[0]||(t[0]=m("span",{class:"arrow"},null,-1))],8,kt),m("div",{class:"submenu-wrapper",style:G({height:e.openSubmenus.includes(s.path)?e.submenuHeight[s.path]+"px":"0"})},[m("ul",Et,[(d(!0),v(W,null,ie(s.children,i=>(d(),v("li",{key:i.path,class:x(["submenu-item",{active:e.activeIndex===i.path}]),onClick:f=>e.handleMenuClick(i.path)},B(i.title),11,Dt))),128))])],4)],2)):(d(),v("li",{key:0,class:x(["menu-item",{active:e.activeIndex===s.path}]),onClick:i=>e.handleMenuClick(s.path)},[m("img",{src:s.icon,alt:"",class:"menu-icon"},null,8,bt),m("span",xt,B(s.title),1)],10,Ct))],64))),128))])],2)}const At=re(ht,[["render",Mt],["__scopeId","data-v-47a8aff1"],["__file","D:/临时存放/green-carbon-1.0/src/components/nav/NavList.vue"]]),It={__name:"Header",props:{isCollapse:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0}},emits:["update:isCollapse","fullscreenChange"],setup(p,{expose:t,emit:r}){t();let e=u(!1);const o=p,g=r,s=Q(),i=Y(),f=K(),n=X(),k=le(),_=j(),a=u(i.currentCompany),h=u(!1),C=u(null),b=u({oldPassword:"",newPassword:"",confirmPassword:""}),L={oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:(y,H,oe)=>{H!==b.value.newPassword?oe(new Error("两次输入的密码不一致")):oe()},trigger:"blur"}]};te(a,async(y,H)=>{y!==H&&await w(y)});const T=E(()=>s.userinfo||{}),A=()=>{g("update:isCollapse",!o.isCollapse)},w=async y=>{if(y)try{i.setCurrentCompany(y),await Promise.all([f.fetchAreas(),n.fetchMeterList()]),V.success("公司切换成功")}catch{V.error("数据加载失败，请重试")}},D=async y=>{switch(y){case"userInfo":_.push("/user-info");break;case"changePassword":h.value=!0;break;case"logout":await N();break}},I=()=>{C.value&&C.value.resetFields(),b.value={oldPassword:"",newPassword:"",confirmPassword:""}},$=async()=>{if(C.value)try{e.value=!0,await C.value.validate(),await me({username:T.value.username,id:T.value.id,oldPassword:ee(b.value.oldPassword),password:ee(b.value.newPassword)}),V.success("密码修改成功"),h.value=!1,I()}catch(y){y.message?V.error(y.message):V.error("密码修改失败，请重试")}finally{e.value=!1}},N=async()=>{try{await et.confirm("确认退出登录吗？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}),localStorage.removeItem("permissions"),await ce(),_.push("/login"),V.success("已安全退出登录")}catch(y){y!=="cancel"&&(console.error(y),V.error("退出登录失败"))}},S={get passwordLoading(){return e},set passwordLoading(y){e=y},props:o,emit:g,userStore:s,companyStore:i,areaStore:f,meterStore:n,route:k,router:_,currentCompany:a,passwordDialogVisible:h,passwordFormRef:C,passwordForm:b,passwordRules:L,userInfo:T,toggleAside:A,handleCompanyChange:w,handleCommand:D,resetPasswordForm:I,handlePasswordChange:$,handleLogout:N,ref:u,computed:E,watch:te,get useRoute(){return le},get useRouter(){return j},get Expand(){return Te},get Fold(){return Ve},get CaretBottom(){return Be},get User(){return Fe},get Lock(){return ze},get SwitchButton(){return Ue},get useUserStore(){return Q},get useCompanyStore(){return Y},get useAreaStore(){return K},get useMeterStore(){return X},CompanyAutoInput:Ze,get logoutApi(){return ce},get changePasswordApi(){return me},get sha256(){return ee}};return Object.defineProperty(S,"__isScriptSetup",{enumerable:!1,value:!0}),S}},Lt={class:"header-left"},Tt={class:"header-right"},Vt={class:"company-selector"},Bt={class:"user-info"},Ft={class:"username"},zt={class:"dialog-footer"};function Ut(p,t,r,e,o,g){const s=be,i=it,f=Je,n=Ke,k=Xe,_=Ye,a=qe,h=Qe,C=Ce,b=je,L=Ge,T=Le("permission"),A=ye;return d(),M(L,{height:"55px",class:"header"},{default:c(()=>[m("div",Lt,[r.isMobile?(d(),M(s,{key:0,class:"toggle-btn",onClick:e.toggleAside},{default:c(()=>[(d(),M(se(r.isCollapse?"Expand":"Fold")))]),_:1})):z("",!0)]),m("div",Tt,[J((d(),v("div",Vt,[l(e.CompanyAutoInput,{modelValue:e.currentCompany,"onUpdate:modelValue":t[0]||(t[0]=w=>e.currentCompany=w)},null,8,["modelValue"])])),[[T,"manage_company"]]),l(k,{onCommand:e.handleCommand},{dropdown:c(()=>[l(n,null,{default:c(()=>[l(f,{command:"changePassword"},{default:c(()=>[l(s,null,{default:c(()=>[l(e.Lock)]),_:1}),t[6]||(t[6]=F("修改密码 "))]),_:1}),l(f,{divided:"",command:"logout"},{default:c(()=>[l(s,null,{default:c(()=>[l(e.SwitchButton)]),_:1}),t[7]||(t[7]=F("退出登录 "))]),_:1})]),_:1})]),default:c(()=>[m("div",Bt,[l(i,{size:32,class:"user-avatar"},{default:c(()=>{var w,D;return[F(B(((D=(w=e.userInfo.real_name)==null?void 0:w[0])==null?void 0:D.toUpperCase())||"U"),1)]}),_:1}),m("span",Ft,B(e.userInfo.real_name+"：你好呀"||"未登录"),1),l(s,{class:"dropdown-icon"},{default:c(()=>[l(e.CaretBottom)]),_:1})])]),_:1})]),l(b,{modelValue:e.passwordDialogVisible,"onUpdate:modelValue":t[5]||(t[5]=w=>e.passwordDialogVisible=w),title:"修改密码",width:"400px",onClose:e.resetPasswordForm},{footer:c(()=>[m("span",zt,[l(C,{onClick:t[4]||(t[4]=w=>e.passwordDialogVisible=!1)},{default:c(()=>t[8]||(t[8]=[F("取消")])),_:1}),l(C,{type:"primary",onClick:e.handlePasswordChange},{default:c(()=>t[9]||(t[9]=[F("确认")])),_:1})])]),default:c(()=>[J((d(),M(h,{ref:"passwordFormRef",model:e.passwordForm,rules:e.passwordRules,"label-width":"100px"},{default:c(()=>[l(a,{label:"旧密码",prop:"oldPassword"},{default:c(()=>[l(_,{modelValue:e.passwordForm.oldPassword,"onUpdate:modelValue":t[1]||(t[1]=w=>e.passwordForm.oldPassword=w),type:"password",placeholder:"请输入旧密码","show-password":""},null,8,["modelValue"])]),_:1}),l(a,{label:"新密码",prop:"newPassword"},{default:c(()=>[l(_,{modelValue:e.passwordForm.newPassword,"onUpdate:modelValue":t[2]||(t[2]=w=>e.passwordForm.newPassword=w),type:"password",placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),l(a,{label:"确认新密码",prop:"confirmPassword"},{default:c(()=>[l(_,{modelValue:e.passwordForm.confirmPassword,"onUpdate:modelValue":t[3]||(t[3]=w=>e.passwordForm.confirmPassword=w),type:"password",placeholder:"请再次输入新密码","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[A,e.passwordLoading]])]),_:1},8,["modelValue"])]),_:1})}const Nt=re(It,[["render",Ut],["__scopeId","data-v-c7591e26"],["__file","D:/临时存放/green-carbon-1.0/src/components/header/Header.vue"]]),Rt={__name:"index",setup(p,{expose:t}){t();const r=u(!1),e=u(!1),o=u(!1),g=u(!1),s=u(!1),i=u(""),f=u(!1),n=Q(),k=Y(),_=K(),a=X(),h=E(()=>({width:e.value?r.value?"0":"260px":r.value?"4rem":"260px",borderRadius:"8px"})),C=E(()=>({marginLeft:o.value?"0":"auto"})),b=async()=>{f.value=!0;try{await n.getUserInfo(),k.setCurrentCompany(n.userCompany),await Promise.all([_.fetchAreas(),a.fetchMeterList()]),g.value=!0,s.value=!1}catch(S){s.value=!0,i.value="初始化数据失败，请刷新页面重试",O({type:"error",title:"错误",message:i.value,duration:0,showClose:!0}),console.error("初始化失败:",S)}finally{f.value=!1}},L=()=>{e.value&&(r.value=!r.value)},T=S=>{r.value=S},A=()=>{const S=window.innerWidth<=768;e.value!==S&&(e.value=S,r.value=S)},w=S=>{o.value=S},D=u(navigator.onLine),I=()=>{D.value=navigator.onLine,D.value?(s.value=!1,i.value="",O.closeAll(),b()):(s.value=!0,i.value="网络连接不可用，请检查您的网络",O({type:"warning",title:"网络警告",message:i.value,duration:0,showClose:!0}))};q(async()=>{A(),window.addEventListener("resize",A),window.addEventListener("online",I),window.addEventListener("offline",I),D.value?await b():(s.value=!0,i.value="网络连接不可用，请检查您的网络",O({type:"warning",title:"网络警告",message:i.value,duration:0,showClose:!0}))}),de(()=>{window.removeEventListener("resize",A),window.removeEventListener("online",I),window.removeEventListener("offline",I)});const $=E(()=>"发生错误"),N={isCollapse:r,isMobile:e,isFullscreen:o,isInitialized:g,hasError:s,errorMessage:i,loading:f,userStore:n,companyStore:k,areaStore:_,meterStore:a,asideStyle:h,mainContainerStyle:C,initializeData:b,toggleAside:L,updateCollapse:T,checkMobile:A,handleFullscreenChange:w,isOnline:D,updateNetworkStatus:I,errorTitle:$,ref:u,computed:E,onMounted:q,onUnmounted:de,NavList:At,AppHeader:Nt,get useUserStore(){return Q},get useCompanyStore(){return Y},get useAreaStore(){return K},get useMeterStore(){return X}};return Object.defineProperty(N,"__isScriptSetup",{enumerable:!1,value:!0}),N}},Gt={class:"logo-container"},Ht={class:"platform-name"},Ot={class:"router-view-container"},Wt={key:2,class:"loading-container"};function jt(p,t,r,e,o,g){const s=He,i=Ne("router-view"),f=Oe,n=We,k=Ce,_=ut,a=ye;return J((d(),M(n,{class:"layout-container"},{default:c(()=>[!e.hasError&&e.isInitialized?(d(),v(W,{key:0},[e.isMobile&&!e.isCollapse?(d(),v("div",{key:0,class:"drawer-overlay",onClick:e.toggleAside})):z("",!0),l(s,{class:x(["aside-container",["aside",{"mobile-aside":e.isMobile}]]),style:G(e.asideStyle)},{default:c(()=>[m("div",Gt,[t[0]||(t[0]=m("img",{style:{"border-radius":"8px"},src:tt,alt:"Logo",class:"logo"},null,-1)),J(m("span",Ht,"融禹智慧能源管理",512),[[Re,!e.isCollapse||e.isMobile]])]),l(e.NavList,{"is-collapse":e.isCollapse,"is-mobile":e.isMobile},null,8,["is-collapse","is-mobile"])]),_:1},8,["class","style"]),l(n,{class:x(["right-container",{"mobile-right":e.isMobile}]),style:G(e.mainContainerStyle)},{default:c(()=>[l(e.AppHeader,{"is-collapse":e.isCollapse,"is-mobile":e.isMobile,"onUpdate:isCollapse":e.updateCollapse,onFullscreenChange:e.handleFullscreenChange},null,8,["is-collapse","is-mobile"]),l(f,{class:"main-content"},{default:c(()=>[m("div",Ot,[l(i)])]),_:1})]),_:1},8,["class","style"])],64)):e.hasError?(d(),M(_,{key:1,icon:"error",title:e.errorTitle,"sub-title":e.errorMessage,class:"error-result"},{extra:c(()=>[l(k,{type:"primary",onClick:e.initializeData},{default:c(()=>t[1]||(t[1]=[F("重试")])),_:1})]),_:1},8,["title","sub-title"])):(d(),v("div",Wt))]),_:1})),[[a,e.loading]])}const Fs=re(Rt,[["render",jt],["__scopeId","data-v-a763a6ae"],["__file","D:/临时存放/green-carbon-1.0/src/views/Home/index.vue"]]);export{Fs as default};
