import{_ as A,r as y,F as E,W as T,c as _,d as f,J as L,X as M,i as t,j as a,e as p,f as l,g as r,I as d,V as Q,T as U,v as W}from"./index-oALI6hjD.js";import{E as j}from"./dialog-B_GDP7gC.js";import"./overlay-WqKCga-H.js";import{E as G}from"./card-DUC90zSS.js";import{E as J,a as K}from"./descriptions-item-5NsjWWYb.js";/* empty css            *//* empty css                */import{E as X}from"./popper-8tqvLSZz.js";import{E as Z}from"./button-CW4VZptJ.js";import{E as $}from"./empty-BnW6BhO3.js";import{u as q,e as H,k as O}from"./meter-GWsXRyue.js";import{f as P}from"./date-LkHkg0he.js";import{_ as R}from"./MeterDialog-CsgwRA3M.js";import{u as Y}from"./area-DGez3_R7.js";import{s as ee}from"./index.vue-Dm5kuiOD.js";import{E as c}from"./index-CV7ElbEQ.js";import{E as te}from"./index-ClN0XSgQ.js";import{s as ae}from"./useParentComponentEffect-CXfAGznX.js";const le={key:1,"element-loading-text":"loading...",class:"meter-detail"},oe={class:"actions"},re={style:{width:"100%"}},se={__name:"DeviceInfo",setup(ne){const u=y(!1),i=q(),e=E(()=>i.currentMeter),m=y(!1),D=E(()=>({id:e.value.parent_id,type:e.value.type}));async function h(){i.currentMeter||i.treeDataForChart||(await i.fetchMeterList(),i.setCurrentMeter(i.treeDataForChart[0]))}h();const k={1:"虚拟设备",2:"大连思捷",3:"迈德",4:"千汇-未知公司token",5:"一个没有名字的智慧管理平台",6:"欧锐德电子"};function C(){m.value=!0}async function S(){m.value=!1,u.value=!0;try{const n=await H({id:e.value.id});n.code!==200?(console.error(n.message),c.error(n.message)):(console.log(n),i.setCurrentMeter(n.data[0]))}catch(n){console.error(n),c.error(n.message||"获取表计信息失败")}finally{u.value=!1}}function x(){u.value=!0;const n=[e.value.id];O(n).then(s=>{s.code===200?(c.success("删除成功"),i.fetchMeterList()):(console.error(s.message),c.error(s.message||"删除失败"))}).catch(s=>{console.error(s),c.error("删除失败")}).finally(()=>{u.value=!1})}return(n,s)=>{const I=$,v=Z,V=X,o=J,w=te,g=K,b=G,B=j,z=T("permission"),F=W;return _(),f(U,null,[e.value?M((_(),f("div",le,[t(b,{class:"box-card"},{header:a(()=>[s[3]||(s[3]=p("span",null,"基本信息",-1)),M((_(),f("div",oe,[t(v,{type:"primary",onClick:C,size:"small"},{default:a(()=>s[1]||(s[1]=[l("编辑")])),_:1}),t(V,{class:"item",effect:"dark",content:"删除表计后，相关数据将被删除，请谨慎操作！",placement:"top"},{default:a(()=>[t(v,{type:"danger",onClick:x,size:"small"},{default:a(()=>s[2]||(s[2]=[l("删除")])),_:1})]),_:1})])),[[z,"manage_device"]])]),default:a(()=>[t(g,{column:2,border:""},{default:a(()=>[t(o,{label:"表计编码"},{default:a(()=>[l(r(e.value.meter_code),1)]),_:1}),t(o,{label:"引擎"},{default:a(()=>[l(r(k[e.value.engine_id]||"未知"),1)]),_:1}),t(o,{label:e.value.engine_id===1?"表计公式":"表计外部ID"},{default:a(()=>[l(r(e.value.meter_id),1)]),_:1},8,["label"]),t(o,{label:"状态"},{default:a(()=>[t(w,{type:e.value.status===1?"success":"danger",effect:"light"},{default:a(()=>[l(r(e.value.status===1?"可用":"不可用"),1)]),_:1},8,["type"])]),_:1}),t(o,{label:"类型"},{default:a(()=>[l(r(e.value.type===1?"水表":e.value.type===2?"电表":"气表"),1)]),_:1}),t(o,{label:"规格"},{default:a(()=>[l(r(e.value.specification||"未知"),1)]),_:1}),t(o,{label:"制造商"},{default:a(()=>[l(r(e.value.manufacturer||"未知"),1)]),_:1}),t(o,{label:"一级分类"},{default:a(()=>[l(r(e.value.sub_category1||"未知"),1)]),_:1}),t(o,{label:"二级分类"},{default:a(()=>[l(r(e.value.sub_category2||"未知"),1)]),_:1}),t(o,{label:"三级分类"},{default:a(()=>[l(r(e.value.sub_category3||"未知"),1)]),_:1}),t(o,{label:"四级分类"},{default:a(()=>[l(r(e.value.sub_category4||"未知"),1)]),_:1})]),_:1})]),_:1}),t(b,{class:"box-card"},{header:a(()=>s[4]||(s[4]=[p("div",{class:"card-header"},[p("span",null,"安装信息")],-1)])),default:a(()=>[t(g,{column:2,border:""},{default:a(()=>[t(o,{label:"安装位置"},{default:a(()=>[l(r(e.value.installation_location||"未知"),1)]),_:1}),t(o,{label:"安装日期"},{default:a(()=>[l(r(d(P)(e.value.installation_date)),1)]),_:1}),t(o,{label:"所供区域"},{default:a(()=>[l(r(d(Y)().getAreaNameById(e.value.area_id)||"未知"),1)]),_:1}),t(o,{label:"信号强度"},{default:a(()=>[l(r(e.value.CSQ),1)]),_:1}),t(o,{label:"经度"},{default:a(()=>[l(r(e.value.longitude||"未知"),1)]),_:1}),t(o,{label:"纬度"},{default:a(()=>[l(r(e.value.latitude||"未知"),1)]),_:1}),t(o,{label:"备注",span:2},{default:a(()=>[l(r(e.value.remarks||"无"),1)]),_:1})]),_:1})]),_:1}),p("div",re,[t(d(ae),{enableScrollWheelZoom:!0,ak:"Kwc6trl7dmb2Go3SM6S5QueuW0Foa0QN",center:{lng:e.value.longitude||108.94682,lat:e.value.latitude||34.26316},zoom:d(Q)().currentCompany.zoom-1||12},{default:a(()=>[t(d(ee),{position:{lng:e.value.longitude,lat:e.value.latitude}},null,8,["position"])]),_:1},8,["center","zoom"])])])),[[F,u.value]]):(_(),L(I,{key:0,description:"请先选择表计"})),t(B,{"destroy-on-close":"",title:e.value?"编辑表计":"新增表计","align-center":"",modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=N=>m.value=N),width:"50%"},{default:a(()=>[t(R,{"onUpdate:visible":S,pMeter:D.value,id:e.value?e.value.id:null},null,8,["pMeter","id"])]),_:1},8,["title","modelValue"])],64)}}},Se=A(se,[["__scopeId","data-v-4ad9d04e"]]);export{Se as D};
