import{_ as S,r as E,F as T,c as i,J as V,j as t,e as p,i as o,f as v,d as C,T as D,U as O,I as w,h as R}from"./index-oALI6hjD.js";import{E as Q}from"./card-DUC90zSS.js";import{E as Y}from"./button-CW4VZptJ.js";/* empty css            */import{E as M,a as j}from"./select-B0JZ5Vmm.js";import"./scrollbar-BwLVa3O8.js";import"./popper-8tqvLSZz.js";import{b as W,a as G}from"./radio-group-C10qSAbV.js";/* empty css                     */import{d as B}from"./dayjs.min-VPOC9PSa.js";import{B as N}from"./BaseChart-CUGvWtWP.js";import{E as J}from"./dialog-B_GDP7gC.js";import"./overlay-WqKCga-H.js";import{E as L,a as H}from"./form-item-JkdAUXjO.js";import{E as K}from"./input-_j8YarB1.js";import{E as X}from"./input-number-CaAXokvz.js";import{E as Z}from"./index-CV7ElbEQ.js";import"./plugin-vue_export-helper-CqGSI99y.js";import"./index-DXOgsKzf.js";import"./index-GdZBC0LW.js";import"./use-form-item-CJ5jT23N.js";import"./icon-DFUaFmZd.js";import"./index-ClN0XSgQ.js";import"./castArray-DuUCQlE9.js";import"./index-Ci2yyUHC.js";import"./index-BTnVmvBQ.js";import"./aria-BUADUvnR.js";import"./scroll-BUhzRsoy.js";import"./isEqual-DERyOhzh.js";import"./_Uint8Array-Cyhry7Ym.js";import"./_baseIteratee-_-ChXyeP.js";import"./index-CPa7yTdP.js";import"./focus-trap-B9jhWFgs.js";import"./DebounceAndThrottle-B_grFKK4.js";import"./installCanvasRenderer-7dDAEUGk.js";import"./index-JdeAZNwx.js";import"./vnode-DAFY4x8G.js";import"./refs-sNzFHjPI.js";import"./_initCloneObject-CeA08_Bb.js";import"./index-Civq4TP6.js";const ee={class:"dialog-footer"},le={__name:"WaterPlanDialog",props:{visible:{type:Boolean,required:!0},planType:{type:String,required:!0}},emits:["update:visible","submit"],setup($,{emit:b}){const U=$,k=b,h=E(null),y=T({get:()=>U.visible,set:m=>k("update:visible",m)}),n=E({year:"",month:"",quarter:"",plannedUsage:0,remark:""}),I={year:[{required:!0,message:"请选择年份",trigger:"change"}],month:[{required:!0,message:"请选择月份",trigger:"change"}],quarter:[{required:!0,message:"请选择季度",trigger:"change"}],plannedUsage:[{required:!0,message:"请输入计划用水量",trigger:"blur"}]},z=T(()=>{const m=B().year();return Array.from({length:4},(r,d)=>({label:`${m+d}年`,value:m+d}))}),x=Array.from({length:12},(m,r)=>({label:`${r+1}月`,value:r+1})),_=Array.from({length:4},(m,r)=>({label:`Q${r+1}`,value:r+1})),q=()=>{var m;(m=h.value)==null||m.resetFields(),y.value=!1},P=async()=>{h.value&&await h.value.validate(m=>{m&&(k("submit",{...n.value,planType:U.planType}),q())})};return(m,r)=>{const d=M,A=j,l=L,e=X,u=K,c=H,f=Y,g=J;return i(),V(g,{modelValue:y.value,"onUpdate:modelValue":r[5]||(r[5]=a=>y.value=a),title:"添加用水计划",width:"500px","before-close":q},{footer:t(()=>[p("span",ee,[o(f,{onClick:q},{default:t(()=>r[6]||(r[6]=[v("取消")])),_:1}),o(f,{type:"primary",onClick:P},{default:t(()=>r[7]||(r[7]=[v("确定")])),_:1})])]),default:t(()=>[o(c,{ref_key:"formRef",ref:h,model:n.value,rules:I,"label-width":"100px"},{default:t(()=>[o(l,{label:"年份",prop:"year"},{default:t(()=>[o(A,{modelValue:n.value.year,"onUpdate:modelValue":r[0]||(r[0]=a=>n.value.year=a),placeholder:"请选择年份"},{default:t(()=>[(i(!0),C(D,null,O(z.value,a=>(i(),V(d,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),$.planType==="month"?(i(),V(l,{key:0,label:"月份",prop:"month"},{default:t(()=>[o(A,{modelValue:n.value.month,"onUpdate:modelValue":r[1]||(r[1]=a=>n.value.month=a),placeholder:"请选择月份"},{default:t(()=>[(i(!0),C(D,null,O(w(x),a=>(i(),V(d,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):R("",!0),$.planType==="quarter"?(i(),V(l,{key:1,label:"季度",prop:"quarter"},{default:t(()=>[o(A,{modelValue:n.value.quarter,"onUpdate:modelValue":r[2]||(r[2]=a=>n.value.quarter=a),placeholder:"请选择季度"},{default:t(()=>[(i(!0),C(D,null,O(w(_),a=>(i(),V(d,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):R("",!0),o(l,{label:"计划用水量",prop:"plannedUsage"},{default:t(()=>[o(e,{modelValue:n.value.plannedUsage,"onUpdate:modelValue":r[3]||(r[3]=a=>n.value.plannedUsage=a),min:0,precision:2,step:.1,class:"w-full"},null,8,["modelValue"])]),_:1}),o(l,{label:"备注",prop:"remark"},{default:t(()=>[o(u,{modelValue:n.value.remark,"onUpdate:modelValue":r[4]||(r[4]=a=>n.value.remark=a),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},ae=S(le,[["__scopeId","data-v-e5b4acdd"]]),te={class:"water-usage"},oe={class:"header"},re={class:"actions"},ne={class:"cards"},se={class:"card-title"},ue={class:"header-actions"},me={class:"cards-row"},ie={class:"card-title"},pe={class:"header-actions"},de={__name:"index",setup($){function b(l,e){return l<<12|1<<e}const U=E("usage"),k=E(!1),h=E(""),y=E({month:b(0,0),quarter:b(1,0),year:b(2,0)}),n=E({monthly:{},quarterly:{},yearly:{}}),I=Array.from({length:12},(l,e)=>({label:`${e+1}月`,value:b(0,e)})),z=Array.from({length:4},(l,e)=>({label:`Q${e+1}`,value:b(1,e)})),x=Array.from({length:4},(l,e)=>({label:B().add(e,"year").format("YYYY"),value:b(2,e)})),_=(l,e)=>Math.floor(Math.random()*(e-l+1)+l),q=(l,e,u)=>{var c,f;return l==="month"?((c=n.value.monthly[e])==null?void 0:c[u])||0:l==="quarter"?((f=n.value.quarterly[e])==null?void 0:f[u])||0:n.value.yearly[e]||0},P=T(()=>({title:!1,xAxisData:I.map(l=>l.label),series:[{name:"实际用水",type:"bar",data:Array.from({length:12},()=>_(60,100))},{name:"计划用水",type:"bar",data:Array.from({length:12},(l,e)=>q("month",B().year(),e+1)||_(60,100))}],customColors:["#fbbf24","#3b82f6"]})),m=T(()=>({title:!1,xAxisData:z.map(l=>l.label),series:[{name:"实际用水",type:"bar",data:Array.from({length:4},()=>_(60,100))},{name:"计划用水",type:"bar",data:Array.from({length:4},(l,e)=>q("quarter",B().year(),e+1)||_(60,100))}],customColors:["#fbbf24","#3b82f6"]})),r=T(()=>({title:!1,xAxisData:x.map(l=>l.label),series:[{name:"实际用水",type:"bar",data:Array.from({length:4},()=>_(60,100))},{name:"计划用水",type:"bar",data:x.map(l=>q("year",parseInt(l.label))||_(60,100))}],customColors:["#fbbf24","#3b82f6"]})),d=l=>{h.value=l,k.value=!0},A=l=>{const{planType:e,year:u,month:c,quarter:f,plannedUsage:g}=l;e==="month"?(n.value.monthly[u]||(n.value.monthly[u]={}),n.value.monthly[u][c]=g):e==="quarter"?(n.value.quarterly[u]||(n.value.quarterly[u]={}),n.value.quarterly[u][f]=g):n.value.yearly[u]=g,Z.success("计划添加成功")};return(l,e)=>{const u=W,c=G,f=M,g=j,a=Y,F=Q;return i(),C("div",te,[p("div",oe,[e[9]||(e[9]=p("h1",{class:"title"},"用水计划",-1)),p("div",re,[o(c,{modelValue:U.value,"onUpdate:modelValue":e[0]||(e[0]=s=>U.value=s),size:"small"},{default:t(()=>[o(u,{label:"usage"},{default:t(()=>e[7]||(e[7]=[v("用水量")])),_:1}),o(u,{label:"cost"},{default:t(()=>e[8]||(e[8]=[v("水费")])),_:1})]),_:1},8,["modelValue"])])]),p("div",ne,[o(F,{class:"usage-card"},{header:t(()=>[p("span",se,[e[10]||(e[10]=v(" 月度用水计划 ")),o(g,{modelValue:y.value.year,"onUpdate:modelValue":e[1]||(e[1]=s=>y.value.year=s),size:"small",class:"time-select"},{default:t(()=>[(i(!0),C(D,null,O(w(x),s=>(i(),V(f,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),p("div",ue,[o(a,{type:"primary",size:"small",onClick:e[2]||(e[2]=s=>d("month"))},{default:t(()=>e[11]||(e[11]=[v(" 添加计划 ")])),_:1})])]),default:t(()=>[o(N,{options:P.value,height:"300px"},null,8,["options"])]),_:1}),p("div",me,[o(F,{class:"usage-card"},{header:t(()=>[p("span",ie,[e[12]||(e[12]=v(" 季度用水计划 ")),o(g,{modelValue:y.value.year,"onUpdate:modelValue":e[3]||(e[3]=s=>y.value.year=s),size:"small",class:"time-select"},{default:t(()=>[(i(!0),C(D,null,O(w(x),s=>(i(),V(f,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),p("div",pe,[o(a,{type:"primary",size:"small",onClick:e[4]||(e[4]=s=>d("quarter"))},{default:t(()=>e[13]||(e[13]=[v(" 添加计划 ")])),_:1})])]),default:t(()=>[o(N,{options:m.value,height:"300px"},null,8,["options"])]),_:1}),o(F,{class:"usage-card"},{header:t(()=>[e[15]||(e[15]=p("span",{class:"card-title"},"年度用水计划",-1)),o(a,{type:"primary",size:"small",onClick:e[5]||(e[5]=s=>d("year"))},{default:t(()=>e[14]||(e[14]=[v(" 添加计划 ")])),_:1})]),default:t(()=>[o(N,{options:r.value,height:"300px"},null,8,["options"])]),_:1})])]),o(ae,{visible:k.value,"onUpdate:visible":e[6]||(e[6]=s=>k.value=s),"plan-type":h.value,onSubmit:A},null,8,["visible","plan-type"])])}}},Ze=S(de,[["__scopeId","data-v-fcfdf7a3"]]);export{Ze as default};
