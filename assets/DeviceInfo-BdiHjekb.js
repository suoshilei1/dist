import{_ as Q,r as g,F as M,o as T,W as k,X as W,c as u,d as c,J as j,Y as D,i as t,j as a,e as p,f as l,g as o,I as m,U as G,v as J}from"./index-Bx6Y8L80.js";import{E as K}from"./dialog-Dt2QUqOw.js";import"./overlay-04qnzRyj.js";import{E as X}from"./card-fNeABwz5.js";import{E as Y,a as Z}from"./descriptions-item-D8CFypBh.js";/* empty css            *//* empty css                */import{E as $}from"./popper-DBn8ulUn.js";import{E as q}from"./button-8bviUT_H.js";import{E as H}from"./empty-CF5nbTvc.js";import{u as O,e as P,k as R}from"./meter-5sbrBbgq.js";import{f as ee}from"./date-Cgy1PrMx.js";import{_ as te}from"./MeterDialog-C3DuWE-y.js";import{u as ae}from"./area-COPnz-hV.js";import{g as le}from"./formula-ClsumsYI.js";import{h as oe}from"./handleError-DD4JYoq7.js";import{s as re}from"./index.vue-_4S1JAn5.js";import{E as _}from"./index-KJp6TXG9.js";import{E as se}from"./index-aFn2MKle.js";import{s as ne}from"./useParentComponentEffect-CXSsrGL2.js";const ie={key:1,"element-loading-text":"loading...",class:"meter-detail"},ue={class:"actions"},de={key:0},ce={key:1},me={style:{width:"100%"}},_e={__name:"DeviceInfo",setup(fe){const y=g([]);function C(n){const r=y.value.find(v=>v.id==n);return r?r.name:""}const d=g(!1),i=O(),e=M(()=>i.currentMeter),f=g(!1),I=M(()=>({id:e.value.parent_id,type:e.value.type}));async function S(){i.currentMeter||i.treeDataForChart||(await i.fetchMeterList(),i.setCurrentMeter(i.treeDataForChart[0]))}S();const w={1:"虚拟设备",2:"大连思捷",3:"迈德",4:"千汇-未知公司token",5:"一个没有名字的智慧管理平台",6:"欧锐德电子"};function x(){f.value=!0}async function B(){f.value=!1,d.value=!0;try{const n=await P({id:e.value.id});n.code!==200?(console.error(n.message),_.error(n.message)):(console.log(n),i.setCurrentMeter(n.data[0]))}catch(n){console.error(n),_.error(n.message||"获取表计信息失败")}finally{d.value=!1}}function F(){d.value=!0;const n=[e.value.id];R(n).then(r=>{r.code===200?(_.success("删除成功"),i.fetchMeterList()):(console.error(r.message),_.error(r.message||"删除失败"))}).catch(r=>{console.error(r),_.error("删除失败")}).finally(()=>{d.value=!1})}return T(async()=>{try{y.value=await le(k().currentCompany.id)}catch(n){oe(n,"获取表计公式名称失败")}}),(n,r)=>{const v=H,b=q,V=$,s=Y,N=se,E=Z,h=X,z=K,L=W("permission"),A=J;return u(),c(G,null,[e.value?D((u(),c("div",ie,[t(h,{class:"box-card"},{header:a(()=>[r[3]||(r[3]=p("span",null,"基本信息",-1)),D((u(),c("div",ue,[t(b,{type:"primary",onClick:x,size:"small"},{default:a(()=>r[1]||(r[1]=[l("编辑")])),_:1}),t(V,{class:"item",effect:"dark",content:"删除表计后，相关数据将被删除，请谨慎操作！",placement:"top"},{default:a(()=>[t(b,{type:"danger",onClick:F,size:"small"},{default:a(()=>r[2]||(r[2]=[l("删除")])),_:1})]),_:1})])),[[L,"manage_device"]])]),default:a(()=>[t(E,{column:2,border:""},{default:a(()=>[t(s,{label:"表计编码"},{default:a(()=>[l(o(e.value.meter_code),1)]),_:1}),t(s,{label:"折标煤系数"},{default:a(()=>[l(o(e.value.standard_coal_factor),1)]),_:1}),t(s,{label:"引擎"},{default:a(()=>[l(o(w[e.value.engine_id]||"未知"),1)]),_:1}),t(s,{label:e.value.engine_id===1?"表计公式":"表计外部ID"},{default:a(()=>[e.value.engine_id!==1?(u(),c("span",de,o(e.value.meter_id),1)):(u(),c("span",ce,o(C(e.value.meter_id)||"未知"),1))]),_:1},8,["label"]),t(s,{label:"状态"},{default:a(()=>[t(N,{type:e.value.status===1?"success":"danger",effect:"light"},{default:a(()=>[l(o(e.value.status===1?"可用":"不可用"),1)]),_:1},8,["type"])]),_:1}),t(s,{label:"类型"},{default:a(()=>[l(o(e.value.type===1?"水表":e.value.type===2?"电表":"气表"),1)]),_:1}),t(s,{label:"规格"},{default:a(()=>[l(o(e.value.specification||"未知"),1)]),_:1}),t(s,{label:"制造商"},{default:a(()=>[l(o(e.value.manufacturer||"未知"),1)]),_:1}),t(s,{label:"一级分类"},{default:a(()=>[l(o(e.value.sub_category1||"未知"),1)]),_:1}),t(s,{label:"二级分类"},{default:a(()=>[l(o(e.value.sub_category2||"未知"),1)]),_:1}),t(s,{label:"三级分类"},{default:a(()=>[l(o(e.value.sub_category3||"未知"),1)]),_:1}),t(s,{label:"四级分类"},{default:a(()=>[l(o(e.value.sub_category4||"未知"),1)]),_:1})]),_:1})]),_:1}),t(h,{class:"box-card"},{header:a(()=>r[4]||(r[4]=[p("div",{class:"card-header"},[p("span",null,"安装信息")],-1)])),default:a(()=>[t(E,{column:2,border:""},{default:a(()=>[t(s,{label:"安装位置"},{default:a(()=>[l(o(e.value.installation_location||"未知"),1)]),_:1}),t(s,{label:"安装日期"},{default:a(()=>[l(o(m(ee)(e.value.installation_date)),1)]),_:1}),t(s,{label:"所供区域"},{default:a(()=>[l(o(m(ae)().getAreaNameById(e.value.area_id)||"未知"),1)]),_:1}),t(s,{label:"信号强度"},{default:a(()=>[l(o(e.value.CSQ),1)]),_:1}),t(s,{label:"经度"},{default:a(()=>[l(o(e.value.longitude||"未知"),1)]),_:1}),t(s,{label:"纬度"},{default:a(()=>[l(o(e.value.latitude||"未知"),1)]),_:1}),t(s,{label:"备注",span:2},{default:a(()=>[l(o(e.value.remarks||"无"),1)]),_:1})]),_:1})]),_:1}),p("div",me,[t(m(ne),{enableScrollWheelZoom:!0,ak:"Kwc6trl7dmb2Go3SM6S5QueuW0Foa0QN",center:{lng:e.value.longitude||108.94682,lat:e.value.latitude||34.26316},zoom:m(k)().currentCompany.zoom-1||12},{default:a(()=>[t(m(re),{position:{lng:e.value.longitude,lat:e.value.latitude}},null,8,["position"])]),_:1},8,["center","zoom"])])])),[[A,d.value]]):(u(),j(v,{key:0,description:"请先选择表计"})),t(z,{"destroy-on-close":"",title:e.value?"编辑表计":"新增表计","align-center":"",modelValue:f.value,"onUpdate:modelValue":r[0]||(r[0]=U=>f.value=U),width:"50%"},{default:a(()=>[t(te,{"onUpdate:visible":B,pMeter:I.value,id:e.value?e.value.id:null},null,8,["pMeter","id"])]),_:1},8,["title","modelValue"])],64)}}},Le=Q(_e,[["__scopeId","data-v-ecc6e870"]]);export{Le as D};
